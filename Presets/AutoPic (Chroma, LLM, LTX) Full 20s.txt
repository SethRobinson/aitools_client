COMMAND_START|joblist
command @llm_prompt_set_base_prompt
Your job is to look at the following text/story and illustrate ONLY THE LAST SCENE - the most recent thing that happened. You will be sent an entire story but you must focus only on the very end.

Do not include any choices or options. Don't create new story, just illustrate what just recently happened. The video prompt is ONLY of the very END of the story, the last scene/text reply.

Create TWO separate prompts for AI generation:
1. SET_PROMPT1: A static image description for the last scene (for text-to-image AI)
2. SET_PROMPT2: Action and dialog script for what happens in that scene (for image-to-video AI)

**** PROMPT 1 RULES (Static Image) ****
Describe ONLY what the camera sees in one frozen moment:
- The scene/setting (location, lighting, atmosphere)
- People: age, ethnicity, clothing, hair, physical appearance, pose, expression
- Composition and framing

DO NOT include in PROMPT1:
- Dialogue or speech
- Actions or movement
- Story sequences

EXAMPLE PROMPT1:
"A dimly lit diner at night. A broad man in his early 50s sits at the counter, weathered tanned skin, gray-streaked brown hair cropped short under a faded John Deere cap. He wears a flannel shirt rolled to the elbows. Across from him, a middle-aged waitress leans in with penciled eyebrows drawn together. Fluorescent lights buzz overhead, rain streaks down the plate glass windows."

**** PROMPT 2 RULES (20-Second Video Action/Dialog) ****
This is for a 20-SECOND video clip. You need to FILL this time with meaningful action and dialog!

Write a substantial paragraph with enough content for 20 seconds:
- Multiple exchanges of dialog between characters (4-8 lines is appropriate)
- Several actions and reactions
- Stay in ONE location - don't move the camera to a new place
- If the story moves locations, pick the most important scene and expand on it
- Actions described in sequence using "then", "as", "suddenly"
- Build tension or emotion through the exchange

Dialogue format: The [description] (tone): "Line."

*** ABSOLUTELY NO CHARACTER NAMES IN PROMPT2! ***
The video AI has NO IDEA who "Yuki", "Kenji", "Sarah", or "Mr. Thompson" are.
You MUST replace ALL names with visual descriptions EVERYWHERE in PROMPT2:
- In narrative: "The young woman kneels down" NOT "Yuki kneels down"
- In dialog tags: "The older man (frustrated):" NOT "Hiroshi (frustrated):"
- In references: "she turns to the tall man" NOT "she turns to Kenji"

*** DESCRIPTIONS MUST MATCH PROMPT1 EXACTLY! ***
Only use details you actually wrote in PROMPT1. Do NOT invent new details.
- If PROMPT1 says "kimono with cherry blossom patterns", say "the woman in the kimono" NOT "the woman in the blue kimono"
- If PROMPT1 says "brown coat", say "the man in the brown coat" NOT "the man in the gray coat"
- Keep it simple: "the young woman", "the older man", "the merchant" - don't add colors/details you didn't establish

DO NOT include in PROMPT2:
- Initial scene description (we already have the image)
- Character appearance descriptions (already established)
- ANY character names from the story - not even once!
- The word "cinematic"

GOOD EXAMPLE PROMPT2 (20 seconds - fill the time!):
"The older man sets down his coffee mug and sighs heavily. The older man (frustrated): 'You said you'd be there. You promised.' The waitress looks away for a moment, then back at him. The waitress (defensive): 'Something came up. You know how it is.' He unfolds his arms and takes a step closer. The older man (quieter, hurt): 'Three years. Three years and you still can't just tell me the truth.' The waitress's expression softens. She reaches out and touches his arm. The waitress (gentle): 'I wanted to tell you. I just... I didn't know how.' He looks down at her hand, then back up at her face. The older man (resigned): 'Then tell me now.'"

BAD EXAMPLE (too short for 20 seconds):
"The man sighs. The waitress looks away. He steps closer." - NOT ENOUGH! You need dialog and reactions to fill 20 seconds!

**** CRITICAL RULES ****
- Output ONLY the two prompts with their labels. No explanations.
- Be LITERAL and CLEAR, not poetic or vague.
- Keep the user's core idea intact. DO NOT replace it with something else.
- Describe what the camera SEES, not feelings or abstract concepts.
- ALWAYS FULLY DESCRIBE PERSONS in PROMPT1! Age, race, clothing, pose, everything!
- ONLY describe what's happening in the LATEST scene of the story.
- PROMPT2 MUST HAVE ZERO CHARACTER NAMES! Replace every single name with a visual description!
- Do not use ALL CAPS for character references - use normal case like "The young woman"
- PROMPT2 descriptions must match PROMPT1! Don't invent colors or details you didn't write!
- PROMPT2 is 20 SECONDS! Fill the time with dialog and action - don't be too brief!

******* STORY STARTS HERE

@end
command @llm_prompt_add_from_user

********* END STORY

Format your response EXACTLY as:
SET_PROMPT1: [detailed static image description ~150 words]
SET_PROMPT2: [20-second action/dialog, ~150-200 words to fill the time]

@end

call_llm
command @parse_llm_prompts

-Use PROMPT1 for the static image generation with Chroma
command @copy|prompt_1|prompt|

-make starting image (960x576)
text_to_img_chroma.json @replace|"width": 1024|"width": 960| @replace|"height": 1024|"height": 576| @replace|Chroma1-HD-fp8_scaled_defaultloader_hybrid_large_rev2.safetensors|Chroma1-HD-fp8_scaled_defaultloader_hybrid_large_rev2.safetensors|

-higher quality 1280x720 (uncomment to use)
-text_to_img_chroma.json @replace|"width": 1024|"width": 1280| @replace|"height": 1024|"height": 720| @replace|Chroma1-HD-fp8_scaled_defaultloader_hybrid_large_rev2.safetensors|Chroma1-HD-fp8_scaled_defaultloader_hybrid_large_rev2.safetensors|

-Use PROMPT2 for the video generation with LTX
command @copy|prompt_2|prompt|

-LTX 960x576
img_to_video_ltx.json @upload|image1|input1| @replace|"width": 960|"width": 960| @replace|"height": 576|"height": 576| @replace|"value": 121|"value": 481|

-LTX 1280x720 (uncomment to use)
-img_to_video_ltx.json @upload|image1|input1| @replace|"width": 960|"width": 1280| @replace|"height": 576|"height": 720| @replace|"value": 121|"value": 481|


-signal that we should stop completely
command @stopjob

COMMAND_END
